#redirect /pocketbase to /pocketbase/ to ensure the correct URL structure
location /pocketbase {
        return 301 $scheme://$host/pocketbase/;  # Redirect to add trailing slash
    }

    # Handle requests for /pocketbase/ and pass them to the PocketBase application
location ^~ /pocketbase/ {

        # Include proxy configuration
include /config/nginx/proxy.conf;

    # Set the resolver
include /config/nginx/resolver.conf;

        # Define upstream application details
set $upstream_app pocketbase;  # Name of the PocketBase service in Docker
set $upstream_port 8080;        # Port where PocketBase is running
set $upstream_proto http;       # Protocol used (http or https)

    # Strip the /pocketbase/ prefix before proxying to the PocketBase container
rewrite ^/pocketbase(/.*)$ $1 break;

        # Proxy pass to the upstream application
proxy_pass $upstream_proto://$upstream_app:$upstream_port;
}